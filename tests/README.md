# 草稿发布器使用说明

## 功能介绍

草稿发布器 (`publish_draft.py`) 可以将 SiliconMomo 的草稿批量发布到小红书平台。

## 使用前准备

### 1. 启动 Chrome 并开启远程调试

**macOS:**
```bash
/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --remote-debugging-port=9222
```

**Windows:**
```bash
"C:\Program Files\Google\Chrome\Application\chrome.exe" --remote-debugging-port=9222
```

**Linux:**
```bash
google-chrome --remote-debugging-port=9222
```

### 2. 在 Chrome 中登录小红书

1. 访问 https://creator.xiaohongshu.com
2. 完成登录
3. 确保能访问创作者中心

## 运行程序

```bash
cd /Users/zhangqilai/project/vibe-code-100-projects/guiji/SiliconMomo
python tests/publish_draft.py
```

## 命令说明

### 查看草稿列表

```bash
# 查看所有草稿
Momo> list all

# 只查看待发布的草稿
Momo> list ready

# 只查看已发布的草稿
Momo> list published
```

### 发布草稿

```bash
# 发布第1个草稿
Momo> publish 1
```

程序会：
1. 显示要发布的草稿信息
2. 要求确认发布
3. 自动填写标题、内容、上传图片
4. 等待60秒供手动检查
5. 标记草稿为已发布

### 标记草稿（不实际发布）

如果已经手动发布了某个草稿，可以用这个命令更新状态：

```bash
# 标记第2个草稿为已发布
Momo> mark 2
```

### 预览草稿

```bash
# 预览第3个草稿的详细内容
Momo> preview 3
```

### 退出程序

```bash
Momo> quit
```

## 草稿状态说明

| 状态 | 说明 |
|------|------|
| `ready_to_publish` | 待发布 |
| `published` | 已发布 |
| `unused` | 未使用 |

## 工作流程

1. **启动 Chrome** → 开启远程调试端口
2. **登录小红书** → 在浏览器中完成登录
3. **运行程序** → 启动草稿发布器
4. **查看草稿** → 用 `list ready` 查看待发布草稿
5. **预览草稿** → 用 `preview <编号>` 查看详情
6. **发布草稿** → 用 `publish <编号>` 发布
7. **手动确认** → 在浏览器中检查内容并点击发布

## 注意事项

1. **图片上传**: 程序会自动上传图片，如果图片文件不存在会跳过
2. **手动发布**: 程序只负责填写内容，最终的"发布"按钮需要手动点击
3. **等待时间**: 发布流程有60秒等待时间，供检查内容
4. **状态更新**: 发布成功后自动标记草稿为"已发布"

## 常见问题

### Q: 提示"未检测到 Chrome 远程调试端口"

**A:** 请先用命令启动 Chrome 并加上 `--remote-debugging-port=9222` 参数

### Q: 发布后浏览器显示需要登录

**A:** 请在 Chrome 中先访问 https://creator.xiaohongshu.com 完成登录

### Q: 图片上传失败

**A:** 检查图片路径是否正确，文件是否存在

### Q: 如何修改 CDP 端口

**A:** 编辑 `publish_draft.py`，修改 `cdp_url` 参数

## 示例会话

```
╔═══════════════════════════════════════════════════════════════╗
║                                                               ║
║           🧠 SiliconMomo 草稿发布器 v1.0                     ║
║                                                               ║
║           将草稿发布到小红书创作者中心                        ║
║                                                               ║
╚═══════════════════════════════════════════════════════════════╝

✅ 检测到 Chrome 远程调试端口 (9222)

📖 命令说明:
    list [all|ready|published]  - 列出草稿 (默认: all)
    publish <编号>              - 发布指定草稿
    mark <编号>                 - 标记草稿为已发布（不实际发布）
    preview <编号>              - 预览草稿内容
    help                        - 显示帮助信息
    quit/exit                   - 退出程序

🧠 Momo> list ready

================================================================================
📋 草稿列表 (共 3 个)
================================================================================

📝 [1] 5款AI摘要神器⚡效率翻倍！打工人必看！
    状态: ready_to_publish
    创建时间: 2025-01-14 23:42:53
    内容预览: 还在为长文、长视频发愁吗？信息太多看不过来？🤯...
    图片: ✅ /path/to/image.webp
    标签: #AI工具 #效率神器 #打工人必备 #浏览器插件 #信息差

📝 [2] 报告PPT不求人！我的AI流水线作业法🤖
    状态: ready_to_publish
    创建时间: 2025-01-15 06:45:41
    内容预览: 还在为写报告头秃？Momo教你一条龙AI搞定！...
    图片: ✅ /path/to/image.webp

📝 [3] AI一键生成PPT教程，打工人速存！🚀
    状态: ready_to_publish
    创建时间: 2025-01-15 17:30:31
    内容预览: 还在为做PPT头秃吗？🤯 效率党Momo来救场！...
    图片: ✅ /path/to/image.webp

================================================================================

🧠 Momo> publish 1

================================================================================
🚀 开始发布: 《5款AI摘要神器⚡效率翻倍！打工人必看！》
================================================================================

✅ 浏览器连接成功
✅ 登录状态检查完成

导航到创作者中心...
点击发布笔记按钮...
切换到上传图文选项卡...
开始图片上传流程...
图片上传并处理成功 (检测到可见的预览元素)
开始输入标题和内容...
输入标题...
输入内容...
请手动检查内容并点击发布按钮完成发布...

================================================================================
✅ 发布流程完成: 《5款AI摘要神器⚡效率翻倍！打工人必看！》
================================================================================

✅ 已标记草稿为已发布: 《5款AI摘要神器⚡效率翻倍！打工人必看！》

🧠 Momo> quit

👋 再见！
```
